(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t){},18:function(e,t,a){e.exports=a(43)},23:function(e,t,a){},30:function(e,t){},31:function(e,t){},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n,r,c=a(0),l=a.n(c),o=a(12),s=a.n(o),i=(a(23),a(13)),u=a(7),m=a(17),d=a(1),f=a(3),b=a.n(f),g=a(8),p=a.n(g),v=a(14),E=a(4),h="AIzaSyA_fdJhInwwadaeFnUAe-r18Wzhx4S3-o4",N=function(){return l.a.createElement("span",null,"Carregando")},w=(a(38),500),O=function(e){return!!e.latitude&&!!e.longitude},y=function(e){var t=e.NM_LOGRADO,a=e.NU_NUMERO;return"".concat(t," ").concat(a," S\xe3o Carlos - SP")},k=l.a.memo(function(e){var t=e.data,a=e.isActive,n=(e.headers,e.setData),r=e.downloadData,o=e.close,s=Object(c.useState)(!1),i=Object(d.a)(s,2),u=i[0],m=i[1];return console.log("function",u),l.a.createElement(E.a,{params:{key:h,libraries:"places,geometry"},render:function(e){if(!e)return l.a.createElement(N,null);console.log("return ReactGoogleMapLoader",u);var c=new e.Geocoder,s=function(t){return new Promise(function(a,n){setTimeout(function(){console.log("geocoder",(new Date).getSeconds(),t),c.geocode({address:t},function(t,r){r===e.GeocoderStatus.OK?a(t[0]):(console.error(r),n(r))})},w)})},i=t.filter(function(e){return!O(e)}).map(function(e){return{tries:0,row:e}}),d=function(){var e=!0,t=!1,a=void 0;try{for(var n,r=i[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var c=n.value;if(c.tries<3)return c}}catch(l){t=!0,a=l}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}},f=function(){var e=Object(v.a)(p.a.mark(function e(){var a,r,c,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d(),console.log("getAllLatLng1",u),a){e.next=4;break}return e.abrupt("return");case 4:return console.log("getAllLatLng2",u),e.prev=5,r=y(a.row),e.next=9,s(r);case 9:c=e.sent,l=c.geometry,console.log("try",u),a.row.latitude=l.location.lat(),a.row.longitude=l.location.lng(),i=i.filter(function(e){return e.row.id!==a.row.id}),n(JSON.stringify(t)),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(5),console.error("getAllLatLng err",e.t0),w+=250,a.tries+=1;case 23:return console.log("final da getAllLatLng",u),e.next=26,f();case 26:case"end":return e.stop()}},e,null,[[5,18]])}));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:"modal ".concat(a&&"is-active")},l.a.createElement("div",{className:"modal-background",onClick:o}),l.a.createElement("div",{className:"modal-card"},l.a.createElement("header",{className:"modal-card-head"},l.a.createElement("p",{className:"modal-card-title"},"Obter latitude e longitude de ",t.length," dados"),l.a.createElement("button",{className:"delete","aria-label":"close",onClick:o})),l.a.createElement("section",{className:"modal-card-body"},l.a.createElement("p",{className:"title is-6"},"Dados com latitude e longitude:"," ",t.filter(function(e){return O(e)}).length),l.a.createElement("hr",null),l.a.createElement("p",{className:"title is-6"},"Dados sem latitude e longitude:"," ",t.filter(function(e){return!O(e)}).length)),l.a.createElement("footer",{className:"modal-card-foot",style:{justifyContent:"space-between"}},u?l.a.createElement("button",{className:"button is-success",onClick:function(){console.log(u)}},"Parar"):l.a.createElement("button",{className:"button is-success",disabled:0===t.filter(function(e){return!O(e)}).length,onClick:function(){console.log("startGeocoder1",u),m(!0),console.log("startGeocoder2",u),f().then(function(){console.log("AAAAAAAAAA",u)}).catch(function(e){return console.error("err2",e)})}},"Obter lat/lng"),l.a.createElement("button",{className:"button",onClick:r},"Baixar novo arquivo"))),l.a.createElement("button",{className:"modal-close is-large","aria-label":"close"}))}})}),j=(a(39),[]),S=l.a.memo(function(e){var t=e.setRowDetails,a=e.data,o=Object(c.useRef)(null);return l.a.createElement(E.a,{params:{key:h,libraries:"places,geometry"},render:function(e){return e&&(n||(n=new e.Map(o.current,{center:{lat:-22.0087,lng:-47.8909},zoom:14})),j.forEach(function(e){return e.setMap(null)}),j=a.map(function(a){var r=new e.LatLng(Number(a.latitude),Number(a.longitude)),c=new e.Marker({position:r,map:n});return c.addListener("dblclick",function(e){t(a)}),c}),r&&r.clearMarkers(),r=new MarkerClusterer(n,j,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})),l.a.createElement("div",{className:"Map",ref:o})}})}),A=(a(40),function(e){var t=e.isActive,a=e.close,n=e.row;return l.a.createElement("div",{className:"modal ".concat(t&&"is-active")},l.a.createElement("div",{className:"modal-background",onClick:a}),l.a.createElement("div",{className:"modal-card"},l.a.createElement("header",{className:"modal-card-head"},l.a.createElement("p",{className:"modal-card-title"},"Detalhes"),l.a.createElement("button",{className:"delete","aria-label":"close",onClick:a})),l.a.createElement("section",{className:"modal-card-body"},l.a.createElement("div",{className:"content"},l.a.createElement("ol",{className:"is-upper-alpha"},Object.entries(n||{}).map(function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return l.a.createElement("li",null,l.a.createElement("strong",null,a,":")," ",n)})))),l.a.createElement("footer",{className:"modal-card-foot"},l.a.createElement("button",{className:"button",onClick:a},"Fechar"))),l.a.createElement("button",{className:"modal-close is-large","aria-label":"close"}))}),x=(a(41),function(){var e=Object(c.useState)(JSON.stringify([])),t=Object(d.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(!1),o=Object(d.a)(r,2),s=(o[0],o[1]),i=Object(c.useState)(""),u=Object(d.a)(i,2),f=u[0],g=u[1],p=Object(c.useState)([]),v=Object(d.a)(p,2),E=v[0],h=v[1],N=Object(c.useState)(!1),w=Object(d.a)(N,2),O=w[0],y=w[1],j=Object(c.useState)(!1),x=Object(d.a)(j,2),C=x[0],D=x[1],L=Object(c.useState)(!1),M=Object(d.a)(L,1)[0],J=Object(c.useState)(null),_=Object(d.a)(J,2),R=_[0],G=_[1],z=Object(c.useRef)(null);return l.a.createElement("div",{className:"Multimapa",onClick:function(){s(!1)}},l.a.createElement(k,{isActive:C,data:JSON.parse(a),headers:E,setData:n,close:function(){D(!1),y(!1)},downloadData:function(){var e=b.a.utils.book_new();e.SheetNames.push("Dados");var t=b.a.utils.json_to_sheet(JSON.parse(a));e.Sheets.Dados=t,b.a.writeFile(e,"".concat(f.split(".")[0],"_lat-lng.xlsx"))}}),l.a.createElement(A,{isActive:!!R,row:R,close:function(){G(null)}}),l.a.createElement("div",{className:"columns is-variable is-1-mobile"},l.a.createElement("nav",{className:"panel column is-narrow is-two-fifths-tablet is-one-quarter-desktop"},l.a.createElement("p",{className:"panel-heading has-text-centered\t"},"Dados Geolocalizados ".concat(f?"- "+f:"")),l.a.createElement("div",{className:"panel-block"},l.a.createElement("input",{style:{display:"none"},accept:".xlsx, .xls, .csv",type:"file",id:"fileInput",ref:z,onChange:function(e){if(e.target.files){y(!0);var t=e.target.files[0];g(t.name);var a=new FileReader;a.readAsBinaryString(t),a.onload=function(){var e=a.result,t=b.a.read(e,{type:"binary"}),r=t.SheetNames[0],c=t.Sheets[r],l=b.a.utils.sheet_to_json(c).map(function(e,t){return Object(m.a)({id:t},e)});n(JSON.stringify(l)),h(function(e){var t=e.reduce(function(e,t){return Object.keys(t).forEach(function(t){return e[t]=1}),e},{});return Object.keys(t)}(l)),y(!0),!function(e){return e.reduce(function(e,t){return e&&!!t.latitude&&!!t.longitude},!0)}(l)&&M?D(!0):y(!1)}}}}),l.a.createElement("button",{className:"button is-primary is-fullwidth ".concat(O?"is-loading":""),onClick:function(){z&&z.current&&z.current.click()}},"Carregar Dados"))),l.a.createElement("div",{id:"maps",className:"column"},l.a.createElement(S,{data:JSON.parse(a),setRowDetails:G}))))});a(42);i.a.add(u.a,u.b);var C=function(){return l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"is-flex has-text-centered header",style:{justifyContent:"center",alignItems:"center"}},l.a.createElement("h1",{className:"is-size-3 has-text-weight-nomral"},"Multimapa")),l.a.createElement("main",{className:"main container is-fullhd"},l.a.createElement(x,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,1,2]]]);
//# sourceMappingURL=main.439ee7b5.chunk.js.map